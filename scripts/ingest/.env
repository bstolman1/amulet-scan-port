# --------------------------------------------
# FETCHER SETTINGS (conservative start, auto-tune up)
# --------------------------------------------
# Start low to avoid 503s, let auto-tuner scale up when API is healthy
PARALLEL_FETCHES=12
MIN_PARALLEL_FETCHES=4
MAX_PARALLEL_FETCHES=24

# Latency thresholds for auto-tuning (milliseconds)
LATENCY_LOW_MS=500
LATENCY_HIGH_MS=2000
LATENCY_CRITICAL_MS=5000

BATCH_SIZE=1000

# --------------------------------------------
# WORKER THREAD SETTINGS
# --------------------------------------------
MAX_WORKERS=24
PARQUET_WORKERS=12
DECODE_WORKERS=4
DECODE_BATCH_SIZE=250
MAX_INFLIGHT_PROCESS=5
CHUNK_SIZE=4096

# --------------------------------------------
# MEMORY SAFETY
# --------------------------------------------
# Clear dedup Set early to prevent "Set maximum size exceeded"
GLOBAL_DEDUP_MAX=100000

# Pause ingestion earlier when heap is filling up
HEAP_PRESSURE_THRESHOLD=0.75

# --------------------------------------------
# COMPRESSION SETTINGS
# --------------------------------------------
ZSTD_LEVEL=2
IO_BUFFER_SIZE=1048576

# --------------------------------------------
# FILE MANAGEMENT
# --------------------------------------------
MAX_ROWS_PER_FILE=50000
MIN_ROWS_PER_FILE=5000
SCAN_URL=https://scan.sv-1.global.canton.network.sync.global/api/scan

# Local paths (used for cursors even in GCS mode)
DATA_DIR=/home/ben/ledger_data
CURSOR_DIR=/home/ben/ledger_data/cursors

# --------------------------------------------
# GOOGLE CLOUD STORAGE (GCP mode)
# --------------------------------------------
GCS_BUCKET=canton-bucket
GCS_ENABLED=true
GCS_UPLOAD_CONCURRENCY=24
GCS_QUEUE_HIGH_WATER=999999
GCS_QUEUE_LOW_WATER=999998
GCS_BYTE_HIGH_WATER=99999999999
GCS_BYTE_LOW_WATER=99999999998
FLUSH_INTERVAL_MS=0

# --------------------------------------------
# GROUPS.IO API
# --------------------------------------------
GROUPS_IO_API_KEY=5ed83f0119c9ab75f5af9d980b504672c4b8504a6144d26cb871fdb50aaf0427
