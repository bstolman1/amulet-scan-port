# --------------------------------------------
# FETCHER SETTINGS (optimized for c3-standard-22: 22 vCPUs, 88 GB RAM)
# --------------------------------------------
# Starting point - will auto-tune between MIN and MAX
PARALLEL_FETCHES=12
MIN_PARALLEL_FETCHES=4
MAX_PARALLEL_FETCHES=28

# Latency thresholds for auto-tuning (milliseconds)
LATENCY_LOW_MS=500
LATENCY_HIGH_MS=2000
LATENCY_CRITICAL_MS=5000

# Larger batches leverage 88GB RAM for fewer API round-trips
BATCH_SIZE=5000

# --------------------------------------------
# WORKER THREAD SETTINGS
# --------------------------------------------
# Matched to vCPU count (22 cores)
MAX_WORKERS=22

# Larger chunks = fewer ZSTD flushes = higher throughput
CHUNK_SIZE=4096

# --------------------------------------------
# COMPRESSION SETTINGS
# --------------------------------------------
# Slightly higher compression, negligible speed loss
ZSTD_LEVEL=2

# Larger I/O buffer for streaming (leverage 88GB RAM)
IO_BUFFER_SIZE=2097152

# --------------------------------------------
# FILE MANAGEMENT
# --------------------------------------------
MAX_ROWS_PER_FILE=25000
SCAN_URL=https://scan.sv-1.global.canton.network.sync.global/api/scan

# Local paths (used for cursors even in GCS mode)
DATA_DIR=/home/ben/ledger_data
CURSOR_DIR=/home/ben/ledger_data/cursors

# --------------------------------------------
# GOOGLE CLOUD STORAGE (GCP mode)
# Set GCS_BUCKET to enable. Files write to /tmp, upload to GCS, then delete locally.
# --------------------------------------------
GCS_BUCKET=canton-bucket
GCS_ENABLED=true

# Upload queue settings (optimized for 22-core VM)
GCS_UPLOAD_CONCURRENCY=16
GCS_QUEUE_HIGH_WATER=250
GCS_QUEUE_LOW_WATER=50

# Faster file writes
FLUSH_INTERVAL_MS=0

# --------------------------------------------
# GROUPS.IO API
# --------------------------------------------
GROUPS_IO_API_KEY=5ed83f0119c9ab75f5af9d980b504672c4b8504a6144d26cb871fdb50aaf0427
